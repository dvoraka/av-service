plugins {
    id "org.akhikhl.gretty" version "1.2.4"
}

dependencies {
    // Spring
    compile("org.springframework:spring-webmvc:${springVersion}")
    compile("org.springframework:spring-aspects:${springVersion}")
    // Spring JMS
    compile("org.springframework:spring-jms")
    compile("org.apache.activemq:activemq-broker")
    // Ehcache
    compile('org.ehcache:ehcache:3.0.0.rc1')
}

task runAmqpServer(type: JavaExec) {
    main = 'dvoraka.avservice.server.AmqpAVServer'
    classpath = sourceSets.main.runtimeClasspath
    environment('spring.profiles.active', 'amqp')
}

gretty {
    jvmArgs = ['-Dspring.profiles.active=rest,amqp']
    integrationTestTask = 'integrationTest'
    servletContainer = 'jetty9'
    contextPath = 'av-service'
}